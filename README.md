# üé≤ AI Dungeon Master RPG Game

A psychologically engaging, choice-driven AI-powered RPG where every decision matters. Stories are dynamically generated by Azure OpenAI with meaningful consequences, character progression, and a satisfying conclusion within 450-500 turns.

## üéÆ Features

- **6 Unique Themes**: Medieval Fantasy, Sci-Fi Space Opera, Gothic Horror, Cyberpunk, Post-Apocalyptic, and Steampunk
- **Dynamic Storytelling**: Powered by Azure OpenAI Responses API for contextual narrative
- **Meaningful Choices**: Every decision has real consequences that echo throughout your journey
- **Character Progression**: Level up, gain experience, and grow from naive to seasoned adventurer
- **Achievement System**: Track major accomplishments and milestones
- **Relationship Tracking**: NPCs remember your actions and react accordingly
- **Story Arcs**: Structured 450-500 turn complete story with satisfying conclusions
- **Past Choice Impact**: Earlier decisions create advantages, disadvantages, and callback moments
- **Multiple Endings**: Conclusion reflects your cumulative choices throughout the game
- **Responsive Design**: Play on desktop or mobile devices

## üéØ Game Design Philosophy

### Psychological Engagement
- **No "correct" answers** - Every choice involves trade-offs
- **Moral dilemmas** - Navigate complex situations with imperfect solutions
- **Consequences** - Your actions have immediate and delayed effects
- **Callbacks** - Past decisions resurface in meaningful ways
- **Character agency** - Feel like your choices truly shape the story

### Narrative Structure (450-500 Turns)
1. **Beginning (0-20%)** - Establish world, introduce NPCs, create mysteries
2. **Rising Action (20-50%)** - Escalate stakes, reveal consequences, deepen relationships
3. **Climax (50-75%)** - Major confrontations shaped by past choices
4. **Resolution (75-95%)** - Tie up story arcs, show cumulative impact
5. **Ending (95-100%)** - Satisfying conclusion reflecting your journey

## üõ†Ô∏è Tech Stack

### Frontend
- React 18
- Vite (development & build tool)
- Axios (API client)
# üé≤ RPG AI Story Game

A polished AI-powered Dungeon Master experience that uses Azure OpenAI to generate clear, easy-to-follow RPG stories. Players choose a theme, make decisions, and watch their character grow through concrete actions, stat changes, and inventory management.

**Repository:** https://github.com/pritam-ray/RPG-AI-story-game-

--

**Quick links**
- **Live backend (local):** `http://localhost:3001`
- **Live frontend (local):** `http://localhost:5175` (Vite chooses an open port by default)

**Highlights**
- Simple, clear story style focused on vivid but easy-to-imagine scenes
- Character advancement via stats: `Health`, `Mana`, `Strength`, `Intelligence`, `Charisma`
- Inventory: pick up and use items; inventory updates automatically
- 6 starting themes (Medieval Fantasy, Sci‚ÄëFi, Gothic Horror, Cyberpunk, Post‚ÄëApocalyptic, Steampunk)

**Table of contents**
- **Project Structure**
- **Prerequisites & Setup**
- **Environment Variables**
- **Running the App (dev)**
- **How It Works**
- **API Endpoints**
- **Prompt & Response Format**
- **Troubleshooting**
- **Future Improvements**
- **License**

## **Project Structure**

Top-level layout:

```
dungion-master-ai-game/
‚îú‚îÄ‚îÄ backend/                # Express server + Azure OpenAI integration
‚îú‚îÄ‚îÄ frontend/               # React + Vite UI
‚îî‚îÄ‚îÄ README.md
```

Key files:
- `backend/server.js` ‚Äî Express app and route registration
- `backend/routes/game.js` ‚Äî Game API (start, action, state, themes)
- `backend/services/openai.js` ‚Äî Azure OpenAI client & prompt builder
- `frontend/src/App.jsx` ‚Äî Main React app
- `frontend/src/components/` ‚Äî UI components (ThemeSelector, StoryDisplay, Choices, Stats)

## **Prerequisites & Setup**

Install Node.js (v18+). Clone the repo and install dependencies separately for backend and frontend.

Backend (PowerShell):
```powershell
cd backend
npm install
```

Frontend (PowerShell):
```powershell
cd frontend
npm install
```

## **Environment Variables**

Create a `.env` in `backend/` (this file is gitignored). Example is in `backend/.env.example`.

Required variables (example values removed for safety):

- `AZURE_OPENAI_ENDPOINT` ‚Äî Your Azure OpenAI endpoint, e.g. `https://<resource>.openai.azure.com`
- `AZURE_OPENAI_API_KEY` ‚Äî Your Azure OpenAI API key
- `AZURE_OPENAI_DEPLOYMENT_NAME` ‚Äî The deployment name (e.g., `GPT-41`)
- `AZURE_OPENAI_API_VERSION` ‚Äî API version (e.g., `2025-01-01-preview`)
- `PORT` ‚Äî Backend port (default `3001`)

Frontend `.env` contains the backend API base URL:

- `VITE_API_URL` ‚Äî e.g. `http://localhost:3001`

## **Running the App (dev)**

Start backend (PowerShell):
```powershell
cd backend
npm run dev
```

Start frontend (PowerShell):
```powershell
cd frontend
npm run dev
```

Open the Vite URL printed in the terminal (e.g. `http://localhost:5175`).

## **How It Works**

- The frontend sends player actions and the current session ID to the backend.
- The backend uses **Azure OpenAI Responses API**, a stateful API that maintains conversation context on Azure's servers.
- Each game session chains responses together using `previous_response_id`, automatically preserving full conversation history.
- The backend sends only the current action and stats to Azure OpenAI, which retrieves full context from the response chain.
- Azure OpenAI returns a JSON payload with `narration`, `choices`, `statChanges`, `itemsFound`, `itemsUsed`, and a `responseId`.
- Backend updates the in-memory session: stores the response ID for chaining, applies stat changes, updates inventory, and appends narration to `storyHistory`.

**Benefits of using Responses API:**
- **Minimal token usage**: Only current action sent, full context maintained server-side
- **Automatic context preservation**: Complete story history stored on Azure's servers
- **Simple implementation**: No threads/assistants to manage, just chain responses
- **Cost effective**: Significantly reduced API costs due to minimal input tokens
- **Unified API**: Combines best features of chat completions and assistants APIs

Note: Sessions are stored in-memory (Map). For production, use a persistent store (Redis, database).

## **API Endpoints**

- `GET /api/game/themes` ‚Äî Returns available themes
- `POST /api/game/start` ‚Äî Start a new game
  - Body: `{ "theme": "medieval-fantasy", "characterName": "Ada" }`
- `POST /api/game/action` ‚Äî Send a player action
  - Body: `{ "sessionId": "game_xxx", "action": "Open the chest" }`
- `GET /api/game/state/:sessionId` ‚Äî Get the current game state

Responses from the backend include updated `characterStats`, `inventory`, `statChanges`, `itemsFound`, and `itemsUsed`.

## **Prompt & Response Format**

The backend uses Azure OpenAI's **Responses API** to maintain conversation context. Each response is chained to the previous one using `previous_response_id`, allowing the model to maintain full story context without resending conversation history.

The model is instructed to reply using a strict JSON format:

```json
{
  "narration": "Short, clear scene text...",
  "choices": ["Choice A","Choice B","Choice C"],
  "statChanges": { "health": 0, "mana": -5, "strength": 0, "intelligence": 0, "charisma": 0 },
  "itemsFound": ["Torch"],
  "itemsUsed": ["Health Potion"]
}
```

Important inventory rules in the prompt:
- `itemsFound` = add to inventory
- `itemsUsed` = remove from inventory (exact name match)

### **Responses API Flow**
1. **First call**: `client.responses.create(model, instructions, input)` ‚Üí Returns `response.id`
2. **Subsequent calls**: `client.responses.create(model, previous_response_id, input)` ‚Üí Full context automatically preserved
3. **No manual history management** - Azure stores complete conversation chain server-side

## **Troubleshooting**

- If the backend fails to start: ensure `PORT` is free and `.env` variables are set.
- If the frontend can't reach the backend: confirm `VITE_API_URL` points to the backend and CORS is enabled.
- If AI responses fail or are slow: verify Azure key, deployment name, and quota in the Azure Portal.

## **Future Improvements**

1. Persist sessions and inventories with a database (MongoDB/Postgres)
2. Add authentication so players can save/load games
3. Implement combat mechanics, skills, and leveling system
4. Add image generation for scenes (Azure DALL¬∑E)
5. Add multiplayer cooperative mode via WebSockets

## **Contributing**

Contributions welcome. Please open issues or PRs. Keep secrets out of commits ‚Äî add any keys to your local `.env` only.

## **License**

This project is provided under the MIT License.

---

If you'd like, I can also:
- Add a `CONTRIBUTING.md` and `CODE_OF_CONDUCT.md`
- Add GitHub Actions workflows for linting and tests
- Create a Docker Compose for local deployment

Tell me which of those you'd like next and I will implement it.

## üé® Character Stats

- **Health**: Survival in combat and dangerous situations (0-100)
- **Mana**: Magical abilities and spells (0-100)
- **Strength**: Physical prowess and combat effectiveness
- **Intelligence**: Problem-solving and magic power
- **Charisma**: Persuasion and making allies

## üîÆ Future Enhancements

1. **User Authentication** - Save games per user with Firebase/Auth0
2. **Persistent Database** - MongoDB/PostgreSQL for game states
3. **Advanced Character Creation** - Choose race, class, and starting stats
4. **Combat System** - Dice rolls and turn-based battles
5. **Image Generation** - Azure DALL-E for scene illustrations
6. **Multiplayer Mode** - Shared adventures with WebSockets
7. **Voice Narration** - Azure Speech Services for audio storytelling
8. **Save/Load System** - Export and import game states
9. **Achievement System** - Track milestones and unlock rewards
10. **Mobile App** - React Native version for iOS and Android

## üêõ Troubleshooting

### Backend won't start
- Check that your Azure OpenAI credentials are correct in `.env`
- Ensure port 3001 is not already in use
- Verify Node.js version is 18+

### Frontend can't connect to backend
- Confirm backend is running on port 3001
- Check `.env` in frontend has correct API URL
- Verify CORS is enabled in backend

### AI responses are slow
- This is normal - Azure OpenAI may take 5-10 seconds
- Consider reducing `max_tokens` in `openai.js` for faster responses
- Check your Azure OpenAI quota and rate limits

## üìù License

This project is open source and available under the MIT License.

## ü§ù Contributing

Contributions are welcome! Feel free to submit issues and pull requests.

## üëè Credits

- Built with Azure OpenAI
- React and Vite
- Express.js
- Designed with ‚ù§Ô∏è for RPG enthusiasts

---

**Enjoy your adventure! May the dice roll in your favor! üé≤‚ú®**
